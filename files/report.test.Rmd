---
title: "BFAST Test Results"
output:
  html_document:
    toc: false
    theme: united
    self_contained: true
---


This document compares CRAN versions of the R packages [bfast](https://cran.r-project.org/web/packages/bfast/index.html) and [strucchange](https://cran.r-project.org/web/packages/strucchange/index.html) with implemented [modifications](https://github.com/appelmar/bfast) in terms of computation times and achieved speedups. It is automatically generated by applying the same functions among the package versions and comparing its output. 


```{r, echo=FALSE, results='hide'}
library(knitr)
bfast.old.env = new.env()
bfast.new.env = new.env()
load("/opt/results/test.results.old.rda", envir = bfast.old.env)
load("/opt/results/test.results.new.rda", envir = bfast.new.env)
fnames = names(bfast.old.env$results)
results = sapply(fnames, function(x) {
  all.equal(bfast.old.env$results[[x]],bfast.new.env$results[[x]])
}, simplify = F)
n_success = sum(sapply(results, isTRUE))
n_failed = sum(!sapply(results, isTRUE))
```


## Summary

* `r n_success` successful
* `r n_failed` failed

## Details

```{r, echo=FALSE, results='asis'}
df = data.frame(f = fnames,result=ifelse(sapply(results, isTRUE),"success","failed"),row.names = NULL,stringsAsFactors = FALSE)
failed = which(!sapply(results, isTRUE))
df$result[failed] = paste(df$result[failed], " [", 1:length(failed) ,"]", sep="")
kable(df,format="markdown")
```



```{r, echo=FALSE, results='asis'}
if (n_failed > 0) {
  cat("## Details of failed tests\n")
  options(max.print = 10)
  for (i in 1:length(failed)) {
    cat(paste("### [", i ,"] ", fnames[failed[i]], "\n", sep=""))
    print(results[[failed[i]]])
    cat("\n")
  }
}
```




---

```{r, echo=FALSE, results='hide'}
str.strucchange.mod = "strucchange:local"
str.bfast.orig = "bfast:cran"
str.bfast.mod = "bfast:local"
str.strucchange.orig = "strucchange:cran"

if (all(file.exists(c("/opt/git-bfast-orig.txt","/opt/git-bfast-mod.txt","/opt/git-strucchange-orig.txt", "/opt/git-strucchange-mod.txt"))))
{
  gitcommit.bfast.orig = readLines("/opt/git-bfast-orig.txt")
  commiturl.bfast.orig = paste("https://github.com/appelmar/bfast/commit/", gitcommit.bfast.orig  , sep="")
  str.bfast.orig  = paste("[bfast:", gitcommit.bfast.orig , "](", commiturl.bfast.orig , ")", sep="")
  
  gitcommit.bfast.mod  = readLines("/opt/git-bfast-mod.txt")
  commiturl.bfast.mod  = paste("https://github.com/appelmar/bfast/commit/", gitcommit.bfast.mod  , sep="")
  str.bfast.mod  = paste("[bfast:", gitcommit.bfast.mod , "](", commiturl.bfast.mod , ")", sep="")
  
  gitcommit.strucchange.orig = readLines("/opt/git-strucchange-orig.txt")
  commiturl.strucchange.orig   = paste("https://github.com/appelmar/strucchange/commit/", gitcommit.strucchange.orig , sep="")
  str.strucchange.orig   = paste("[strucchange:", gitcommit.strucchange.orig  , "](", commiturl.strucchange.orig  , ")", sep="")
  
  gitcommit.strucchange.mod = readLines("/opt/git-strucchange-mod.txt")
  commiturl.strucchange.mod   = paste("https://github.com/appelmar/strucchange/commit/", gitcommit.strucchange.mod , sep="")
  str.strucchange.mod   = paste("[strucchange:", gitcommit.strucchange.mod  , "](", commiturl.strucchange.mod  , ")", sep="")
}
```

_This report has been generated on `r Sys.time()` and compares the reference package versions from `r str.strucchange.orig` and  `r str.bfast.orig` with modified versions from `r str.strucchange.mod` and  `r str.bfast.mod`._




