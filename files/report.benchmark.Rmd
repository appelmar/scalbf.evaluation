---
title: "BFAST Benchmark Results"
output:
  html_document:
    toc: false
    theme: united
    self_contained: true
---


This document compares CRAN versions of the R packages [bfast](https://cran.r-project.org/web/packages/bfast/index.html) and [strucchange](https://cran.r-project.org/web/packages/strucchange/index.html)  with implemented [modifications](https://github.com/appelmar/bfast) in terms of computation times and achieved speedups. It is automatically generated by applying the same functions among the package versions. The table and figure below shows absolute computation times and achieved speedups.


```{r, echo=FALSE, results='asis'}
library(knitr)
bfast.old.env = new.env()
bfast.new.env = new.env()
load("/opt/results/benchmark.results.old.rda", envir = bfast.old.env)
load("/opt/results/benchmark.results.new.rda", envir = bfast.new.env)

r = merge(bfast.old.env$results,bfast.new.env$results,by="f", suffixes=c(".old",".new"))
r$speedup = r$time.old / r$time.new
kable(r,format="markdown")
```


```{r, echo=FALSE,fig.align='center'}
#par(mar=c(5,4,3,2))
par(oma=c(5,0,0,0))
par(cex=0.8)
barplot(horiz=F,height = t(as.matrix(r[,c("time.old","time.new")])), beside = T, names.arg = r$f, ylab="Computation time (seconds)", legend.text=c("CRAN", "SCALBF"), las=3, args.legend=list(x="topleft"))
```


```{r, echo=FALSE, results='asis'}
cat("## Function details\n")
test.env = new.env()
invisible(suppressMessages(source("benchmark.R", local = test.env )))
fs = names(which(sapply(ls(test.env), function(x) {return(class(get(x, envir = test.env)))}) == "function"))
for (i in 1:length(fs)) {
    cat(paste("### ", fs[i] ,"\n","```{r}", "\n", sep=""))
    f <- get(fs[i],envir = test.env)
    print(f)
    cat(paste("\n", "```", "\n", sep=""))
}
```

---


```{r, echo=FALSE, results='hide'}
str.strucchange.mod = "strucchange:local"
str.bfast.orig = "bfast:cran"
str.bfast.mod = "bfast:local"
str.strucchange.orig = "strucchange:cran"

if (all(file.exists(c("/opt/git-bfast-orig.txt","/opt/git-bfast-mod.txt","/opt/git-strucchange-orig.txt", "/opt/git-strucchange-mod.txt"))))
{
  gitcommit.bfast.orig = readLines("/opt/git-bfast-orig.txt")
  commiturl.bfast.orig = paste("https://github.com/appelmar/bfast/commit/", gitcommit.bfast.orig  , sep="")
  str.bfast.orig  = paste("[bfast:", gitcommit.bfast.orig , "](", commiturl.bfast.orig , ")", sep="")
  
  gitcommit.bfast.mod  = readLines("/opt/git-bfast-mod.txt")
  commiturl.bfast.mod  = paste("https://github.com/appelmar/bfast/commit/", gitcommit.bfast.mod  , sep="")
  str.bfast.mod  = paste("[bfast:", gitcommit.bfast.mod , "](", commiturl.bfast.mod , ")", sep="")
  
  gitcommit.strucchange.orig = readLines("/opt/git-strucchange-orig.txt")
  commiturl.strucchange.orig   = paste("https://github.com/appelmar/strucchange/commit/", gitcommit.strucchange.orig , sep="")
  str.strucchange.orig   = paste("[strucchange:", gitcommit.strucchange.orig  , "](", commiturl.strucchange.orig  , ")", sep="")
  
  gitcommit.strucchange.mod = readLines("/opt/git-strucchange-mod.txt")
  commiturl.strucchange.mod   = paste("https://github.com/appelmar/strucchange/commit/", gitcommit.strucchange.mod , sep="")
  str.strucchange.mod   = paste("[strucchange:", gitcommit.strucchange.mod  , "](", commiturl.strucchange.mod  , ")", sep="")
}
```

_This report has been generated on `r Sys.time()` and compares the reference package versions from `r str.strucchange.orig` and  `r str.bfast.orig` with modified versions from `r str.strucchange.mod` and  `r str.bfast.mod`._



